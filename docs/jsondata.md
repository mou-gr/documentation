# Γενικά
Η παραμετροποίηση μιας φόρμας (tab) γίνεται με την περιγραφή σε json format των ιδιοτήτων της φόρμας αλλά και των επιμέρους πεδίων της (columns). Κάθε φόρμα είναι ένας διδιάστατος πίνακας κάθε γραμμή (row) του οποίου αποτελείται από της στήλες που περιγράφονται στο πεδίο columns του αντίστοιχου json. Κάθε στήλη μπορεί να μην εμφανίζεται καθόλου, να εμφανίζεται μόνο στην λεπτομερή φόρμα που ανοίγει με το πάτημα του κουμπιού, ή να εμφανίζεται και στο συνοπτικό πινακάκι στην αρχική οθόνη.
# Αποθήκευση δεδομένων
Τα δεδομένα κάθε φόρμας αποθηκεύονται στον πίνακα ContractModificationHistory στην στήλη CmhWorkingData και ακολουθούν το xsd schema που δηλώνεται στα jsondata. Επομένως τα ονόματα των στηλών (όπως δηλώνονται στα jsondata) πρέπει να συμφωνούν με τα ονόματα που είναι δηλωμένα στο xsd. Το ίδιο ισχύει και για τον τύπο των δεδομένων (πχ δεν μπορεί να αποθηκευτεί κείμενο σε integer πεδίο)
# Δήλωση jsondata
Ποιον πίνακα jsondata θα χρησιμοποιήσει η κάθε φόρμα, δηλώνεται στο αντίστοιχο πεδίο του wizard. Εκεί δηλώνεται το όνομα του πίνακα και προαιρετικά το όνομα του qualifier. Κατά το σχηματισμό της φόρμας διαβάζονται οι εγγραφς του πίνακα jsondata και σχηματίζεται η περιγραφή της φόρμας (Την περιγραφή θα την αποκαλούμαι metadata).
Η δημιουργία των metadata γίνεται με τον εξής τρόπο:
1. Διαβάζονται από τον πίνακα jsondata 4 καταχωρήσεις

| TableName | Qualifier | CallID | CallPhaseID |
| --------- | --------- |------- |------------ |
| from Wizard | null | null | null |
| from Wizard | from Wizard | null | null |
| from Wizard | from Wizard | CallId | null |
| from Wizard | from Wizard | CallId | CallPhaseId |

2. Δημιουργούνται τα τελικά metadata κάνοντας συγχώνευση(merge) όλων των πεδίων. Αν ένα πεδίο εμφανίζεται σε παραπάνω από 1 καταχωρήσεις προτεραιότητα έχει αυτό που βρίσκεται σε πιο κάτω γραμμή σύμφωνα με τον παραπάνω πίνακα.
# Δήλωση Calldata
Έχει αναπτυχθεί η ενοποιημένη υλοποίηση στο πλαίσιο της οποίας υπάρχει ακόμα μία καταχώρηση json με ακόμα μεγαλύτερη προτεραιότητα. 
Αν η συγκεκριμένη δράση εντάσσεται στο πλαίσιο της ενοποιημένης υλοποίησης υπάρχει μια καταχώρηση στον πίνακα invitation που περιέχει μια καταχώρηση για κάθε φόρμα.

Γίνεται αναζήτηση στο json αντικείμενο των Calldata για την ενότητα με όνομα αυτό που αναφρεται στα metadata. Αν βρεθεί τέτοια ενότητα συγχωνεύεται το περιεχόμενό της με τα metadata και δημιουργούνται τα τελικά metadata που περιγράφουν τη φόρμα
# Τεκμηρίωση metadata

| Πεδίο | Τύπος | Σημασία | Παρατηρήσεις |
| --------- | --------- |------- |------------ |
| name | | Σε ποιον πίνακα του xml θα γραφτεί η πληροφορία |  |
| single| text | Αν "1" επιτρέπεται μόνο μία εγγραφή| |
| hidden| text | Αν "1" απενεργοποιείται όλη η φόρμα| |
| hiddenColumns | array[text] ή "*" | Πίνακας με τα ονόματα των στηλών που δεν θα εμφανιστούν. Αν "*" κρύβονται όλες οι στήλες| Χρησιμοποιείται σε συνδυασμό με το showColumns - Μόνο CallData| 
| showColumns| array[text] | Πίνακας με τα ονόματα των στηλών που θα εμφανιστούν. Έχει προτεραιότητα έναντι του hiddenColumns| Χρησιμοποιείται σε συνδυασμό με το hiddenColumns "*" - Μόνο CallData| 
| datafilter| text | sql predicate βάσει του οποίου φιλτράρονται οι γραμμές που θα επιστρέφονται | |
| readonly| text| Αν "1" δεν επιτρέπεται η επεξεργασία | |
| title| text | Ο τίτλος της φόρμας | |
| allowundelete| |  | |
| detail| text| Αν "1" η φόρμα ανοίγει με λεπτομερή εμφάνιση των δεδομένων | |
| display| |  | |
| minRows| number| Στον έλεγχο ορθότητας ελέγχεται αν υπάρχουν τουλάχιστον τόσες καταχωρήσεις| Μόνο στα CallData|
| maxRows| number| Στον έλεγχο ορθότητας ελέγχεται αν υπάρχουν το πολύ τόσες καταχωρήσεις| Μόνο στα CallData|
| minContractorRows| number| Στον έλεγχο ορθότητας ελέγχεται αν υπάρχουν τουλάχιστον τόσες καταχωρήσεις αν φορέα| Μόνο στα CallData|
| maxContractorRows| number| Στον έλεγχο ορθότητας ελέγχεται αν υπάρχουν το πολύ τόσες καταχωρήσεις αν φορέα| Μόνο στα CallData|
| columns| array[column] | μία καταχώρηση για κάθε πεδίο που εμφανίζεται στη φόρμα | |

## Περιγραφή column
| Πεδίο | Τύπος | Σημασία | Παρατηρήσεις |
| --------- | --------- |------- |------------ |
| name | text | To xml πεδίο που θα καταχωρηθε η πληροφορία |  |
| label| text | Το κείμενο που εμφανίζεται δίπλα στο πεδίο| |
| vord| number | Καθορίζει τη σειρά εμφάνισης στη φόρμα| Το μικρότερο πάει πάνω|
| edit| text | Αν "" το πεδίο δεν εμφανίζεται στη φόρμα| |
| view| text | Αν "" το πεδίο δεν εμφανίζεται στo συνοπτικό πινακάκι| Αν edit και view είναι "" τότε το πεδίο δεν εμφανίζεται πουθενά και τα δεδομένα που ενδεχομένως περιέχει δεν έρχονται στον browser. Πεδία που είναι κρυμμένα στα jsondata δεν γίνεται να εμφανιστούν από τα CallData|
| | text | | |
| | text | | |
| | text | | |
| | text | | |
| | text | | |
| | text | | |
| | text | | |
| | text | | |
| | text | | |
| | text | | |
| | text | | |
| | text | | |
| | text | | |


